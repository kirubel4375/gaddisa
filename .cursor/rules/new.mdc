---
description: 
globs: 
alwaysApply: true
---

---

# ðŸ“˜ Telegram Mini App: Emergency Reporting System

**Project Goal:**
Build a Telegram-based mini web app that allows usersâ€”especially womenâ€”to report emergency incidents (e.g., rape, assault) and access location-based information on nearby support agencies (e.g., police, hospitals, NGOs). The system uses **Django + SQLite** as backend, and **Telegram Mini App** as frontend using Telegram's `WebApp` JS SDK.

---

## 1. ðŸ“¦ System Components Overview

| Component           | Description                                                              |
| ------------------- | ------------------------------------------------------------------------ |
| Telegram Bot        | Initiates chat and loads the web app via Telegram Mini App (WebApp SDK). |
| Mini App (Frontend) | A browser-based interface opened inside Telegram using HTML/CSS/JS.      |
| Django App          | REST API backend that manages users, reports, and agencies.              |
| SQLite              | Lightweight DB for development and deployment.                           |
| Django Admin        | Admin panel to manage incident types, agency data, and users.            |
| APIs                | REST APIs for Mini App to submit/get data.                               |
| Telegram JS SDK     | Handles web app context (user ID, language, UI).                         |

---

## 2. ðŸ§© Database Schema (Django ORM using SQLite)

### ðŸ“„ `UserProfile`

| Field        | Type           | Description             |
| ------------ | -------------- | ----------------------- |
| id           | AutoField (PK) | Primary Key             |
| telegram\_id | CharField(50)  | Telegram user ID        |
| language     | CharField(10)  | Preferred language      |
| last\_active | DateTimeField  | Last activity timestamp |

---

### ðŸ“„ `IncidentReport`

| Field            | Type           | Description                         |
| ---------------- | -------------- | ----------------------------------- |
| id               | AutoField (PK) | Primary Key                         |
| user             | ForeignKey     | Linked to UserProfile               |
| type             | CharField(50)  | Incident type (e.g., Rape, Assault) |
| description      | TextField      | Optional incident description       |
| voice\_note\_url | URLField       | Optional voice recording            |
| location         | CharField(255) | Human-readable location             |
| latitude         | FloatField     | GPS latitude                        |
| longitude        | FloatField     | GPS longitude                       |
| submitted\_at    | DateTimeField  | When report was submitted           |

---

### ðŸ“„ `Agency`

| Field     | Type           | Description                       |
| --------- | -------------- | --------------------------------- |
| id        | AutoField (PK) | Primary Key                       |
| name      | CharField(100) | Name of agency                    |
| type      | CharField(50)  | Type: police, hospital, NGO, etc. |
| region    | CharField(100) | Region                            |
| zone      | CharField(100) | Zone                              |
| woreda    | CharField(100) | Woreda                            |
| kebele    | CharField(100) | Kebele                            |
| phone     | CharField(20)  | Phone number                      |
| address   | CharField(255) | Physical address                  |
| latitude  | FloatField     | GPS latitude                      |
| longitude | FloatField     | GPS longitude                     |

---

## 3. ðŸ“Š ERD (Entity Relationship Diagram)

```
+-----------------+          +---------------------+
|   UserProfile   |          |   IncidentReport    |
+-----------------+          +---------------------+
| id (PK)         |<---------| user_id (FK)        |
| telegram_id     |          | type                |
| language        |          | description         |
| last_active     |          | voice_note_url      |
+-----------------+          | location            |
                             | latitude            |
                             | longitude           |
                             | submitted_at        |
                             +---------------------+

+-----------------+
|     Agency      |
+-----------------+
| id (PK)         |
| name            |
| type            |
| region          |
| zone            |
| woreda          |
| kebele          |
| phone           |
| address         |
| latitude        |
| longitude       |
+-----------------+
```

---

## âœ… Key Features to Build

* Telegram bot setup (`/start` â†’ opens web app).
* Mini app frontend using Telegramâ€™s `WebApp` SDK.
* Django backend with SQLite and REST API endpoints.
* Voice and text incident reporting.
* Admin management of reports and agencies.
* Location-based search using userâ€™s GPS or manual region â†’ zone â†’ woreda â†’ kebele selection.
* Support for multiple languages (Amharic, Afaan Oromo, English).
* Secure deployment on VPS or local server.

---
* Postman collection for API testing.

